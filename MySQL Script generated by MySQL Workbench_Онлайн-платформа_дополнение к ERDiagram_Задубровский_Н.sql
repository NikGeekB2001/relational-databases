-- MySQL Script generated by MySQL Workbench
-- Thu Sep 16 21:26:33 2021
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema geekbrains
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema geekbrains
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `geekbrains` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci ;
USE `geekbrains` ;

-- -----------------------------------------------------
-- Table `geekbrains`.`users`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `geekbrains`.`users` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,
  `firstname` VARCHAR(100) NULL DEFAULT NULL COMMENT 'Имя',
  `lastname` VARCHAR(100) NULL DEFAULT NULL COMMENT 'Фамилия',
  `email` VARCHAR(100) NULL DEFAULT NULL,
  `password_hash` VARCHAR(100) NULL DEFAULT NULL,
  `phone` BIGINT NULL DEFAULT NULL,
  `is_deleted` BIT(1) NULL DEFAULT b'0',
  PRIMARY KEY (`id`),
  UNIQUE INDEX `id` (`id` ASC) VISIBLE,
  UNIQUE INDEX `email` (`email` ASC) VISIBLE,
  INDEX `users_firstname_lastname_idx` (`firstname` ASC, `lastname` ASC) VISIBLE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `geekbrains`.`profiles`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `geekbrains`.`profiles` (
  `user_id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,
  `age` VARCHAR(3) NULL DEFAULT NULL COMMENT 'возраст',
  `city` VARCHAR(100) NULL DEFAULT NULL COMMENT 'Город',
  `gender` CHAR(1) NULL DEFAULT NULL COMMENT 'пол',
  `birthday` DATE NULL DEFAULT NULL COMMENT 'День рождение',
  `accounts_id` BIGINT UNSIGNED NULL DEFAULT NULL,
  `created_at` DATETIME NULL DEFAULT CURRENT_TIMESTAMP,
  `hometown` VARCHAR(100) NULL DEFAULT NULL,
  PRIMARY KEY (`user_id`),
  UNIQUE INDEX `user_id` (`user_id` ASC) VISIBLE,
  CONSTRAINT `fk_user_id`
    FOREIGN KEY (`user_id`)
    REFERENCES `geekbrains`.`users` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `geekbrains`.`accounts`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `geekbrains`.`accounts` (
  `user_id` BIGINT UNSIGNED NOT NULL,
  `account_id` BIGINT UNSIGNED NOT NULL,
  `name_webinar` VARCHAR(100) NULL DEFAULT NULL COMMENT 'Имя вебинара',
  `programs` VARCHAR(200) NULL DEFAULT NULL COMMENT 'Программа',
  `events` VARCHAR(250) NULL DEFAULT NULL COMMENT 'Мероприятия',
  PRIMARY KEY (`user_id`),
  INDEX `account_id` (`account_id` ASC) VISIBLE,
  CONSTRAINT `accounts_ibfk_1`
    FOREIGN KEY (`user_id`)
    REFERENCES `geekbrains`.`users` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `accounts_ibfk_2`
    FOREIGN KEY (`account_id`)
    REFERENCES `geekbrains`.`profiles` (`user_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `geekbrains`.`career`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `geekbrains`.`career` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(180) NULL DEFAULT NULL,
  `body` TEXT NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `id` (`id` ASC) VISIBLE,
  INDEX `career_name_idx` (`name` ASC) VISIBLE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `geekbrains`.`courses`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `geekbrains`.`courses` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,
  `users_id` BIGINT UNSIGNED NOT NULL,
  `name_courses` VARCHAR(100) NULL DEFAULT NULL COMMENT 'Название курса',
  `description` VARCHAR(300) NULL DEFAULT NULL COMMENT 'Описание курса',
  `duration` VARCHAR(50) NULL DEFAULT NULL COMMENT 'Продолжительность курса',
  PRIMARY KEY (`id`),
  UNIQUE INDEX `id` (`id` ASC) VISIBLE,
  INDEX `users_id` (`users_id` ASC) VISIBLE,
  CONSTRAINT `courses_ibfk_1`
    FOREIGN KEY (`users_id`)
    REFERENCES `geekbrains`.`users` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `geekbrains`.`events`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `geekbrains`.`events` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(150) NULL DEFAULT NULL COMMENT 'Имя Вебинара',
  `body` TEXT NULL DEFAULT NULL,
  `created_at` DATETIME NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `id` (`id` ASC) VISIBLE,
  INDEX `events_name_idx` (`name` ASC) VISIBLE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `geekbrains`.`knowledge_base`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `geekbrains`.`knowledge_base` (
  `success_story` TEXT NULL DEFAULT NULL COMMENT 'История успеха',
  `for_children` TEXT NULL DEFAULT NULL COMMENT 'Для детей',
  `user_id` BIGINT UNSIGNED NOT NULL,
  `career_id` BIGINT UNSIGNED NOT NULL,
  PRIMARY KEY (`user_id`, `career_id`),
  INDEX `career_id` (`career_id` ASC) VISIBLE,
  CONSTRAINT `knowledge_base_ibfk_1`
    FOREIGN KEY (`user_id`)
    REFERENCES `geekbrains`.`users` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `knowledge_base_ibfk_2`
    FOREIGN KEY (`career_id`)
    REFERENCES `geekbrains`.`events` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `geekbrains`.`messages`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `geekbrains`.`messages` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,
  `from_user_id` BIGINT UNSIGNED NOT NULL,
  `to_user_id` BIGINT UNSIGNED NOT NULL,
  `body` TEXT NULL DEFAULT NULL,
  `created_at` DATETIME NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `id` (`id` ASC) VISIBLE,
  INDEX `from_user_id` (`from_user_id` ASC) VISIBLE,
  INDEX `to_user_id` (`to_user_id` ASC) VISIBLE,
  CONSTRAINT `messages_ibfk_1`
    FOREIGN KEY (`from_user_id`)
    REFERENCES `geekbrains`.`users` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `messages_ibfk_2`
    FOREIGN KEY (`to_user_id`)
    REFERENCES `geekbrains`.`users` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `geekbrains`.`programs`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `geekbrains`.`programs` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,
  `user_id` BIGINT UNSIGNED NOT NULL,
  `acco_id` BIGINT UNSIGNED NULL DEFAULT NULL,
  `my_training_link` VARCHAR(150) NULL DEFAULT NULL COMMENT 'Ссылка на мое обучение',
  `testing_link` VARCHAR(150) NULL DEFAULT NULL COMMENT 'Ссылка тестирование',
  `events_link` VARCHAR(150) NULL DEFAULT NULL COMMENT 'Ссылка мероприятия',
  PRIMARY KEY (`id`),
  UNIQUE INDEX `id` (`id` ASC) VISIBLE,
  UNIQUE INDEX `my_training_link` (`my_training_link` ASC) VISIBLE,
  UNIQUE INDEX `testing_link` (`testing_link` ASC) VISIBLE,
  UNIQUE INDEX `events_link` (`events_link` ASC) VISIBLE,
  INDEX `acco_id` (`acco_id` ASC) VISIBLE,
  INDEX `user_id` (`user_id` ASC) VISIBLE,
  CONSTRAINT `programs_ibfk_1`
    FOREIGN KEY (`acco_id`)
    REFERENCES `geekbrains`.`accounts` (`user_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `programs_ibfk_2`
    FOREIGN KEY (`user_id`)
    REFERENCES `geekbrains`.`users` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `geekbrains`.`webinars`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `geekbrains`.`webinars` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,
  `user_id` BIGINT UNSIGNED NOT NULL,
  `accoun_id` BIGINT UNSIGNED NULL DEFAULT NULL,
  `name_webinar` VARCHAR(150) NULL DEFAULT NULL COMMENT 'Имя вебинара',
  `webinar_programs` VARCHAR(200) NULL DEFAULT NULL COMMENT 'Программа вебинара',
  `link` VARCHAR(150) NULL DEFAULT NULL COMMENT 'Ссылка',
  `description` VARCHAR(350) NULL DEFAULT NULL COMMENT 'Описание вебинара',
  PRIMARY KEY (`id`),
  UNIQUE INDEX `id` (`id` ASC) VISIBLE,
  UNIQUE INDEX `link` (`link` ASC) VISIBLE,
  INDEX `accoun_id` (`accoun_id` ASC) VISIBLE,
  INDEX `user_id` (`user_id` ASC) VISIBLE,
  CONSTRAINT `webinars_ibfk_1`
    FOREIGN KEY (`accoun_id`)
    REFERENCES `geekbrains`.`accounts` (`user_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `webinars_ibfk_2`
    FOREIGN KEY (`user_id`)
    REFERENCES `geekbrains`.`users` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `geekbrains`.`work`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `geekbrains`.`work` (
  `the_company` VARCHAR(180) NULL DEFAULT NULL COMMENT 'Компании',
  `job_openings` VARCHAR(900) NULL DEFAULT NULL COMMENT 'Вакансии',
  `user_id` BIGINT UNSIGNED NOT NULL,
  `career_id` BIGINT UNSIGNED NOT NULL,
  PRIMARY KEY (`user_id`, `career_id`),
  INDEX `career_id` (`career_id` ASC) VISIBLE,
  CONSTRAINT `work_ibfk_1`
    FOREIGN KEY (`user_id`)
    REFERENCES `geekbrains`.`users` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `work_ibfk_2`
    FOREIGN KEY (`career_id`)
    REFERENCES `geekbrains`.`career` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
